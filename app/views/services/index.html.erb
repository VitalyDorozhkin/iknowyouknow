<h1>Services</h1>

<%= render 'layouts/services_sort-form', sort_type: @sort_type, subjects: @subjects, categories: @categories %>
<div id="services">
  <%= render partial:"layouts/services", locals: {services: @services} %>
</div>



<script>
    function formAjaxQuery(e, type) {
        if(e.tagName!=='FORM'){
            let url = type === 'services' ? '/services-short' : '/users-short' ;

            $.ajax({
                url: url,
                method: "GET",
                data: $(e).closest('form').serialize(),
                success: (data) => {
                    $(e).closest('form').next().html(data);
                }
            });
        }

    }

    document.querySelectorAll('form').forEach((form) => {
        form.addEventListener('click', (e) => {formAjaxQuery(e.target, 'services')});
    });


    document.querySelectorAll('.services').forEach((serviceDiv) => {
        serviceDiv.parentNode.parentNode.addEventListener(
            'mouseenter',
            (e) => {
                formAjaxQuery(e.target.querySelector('input'), 'services');
            }
        );
    });


</script>

